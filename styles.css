/* === Anti "rebondissement" (overscroll / rubber band) ===
   - Android/desktop: overscroll-behavior stoppe l'effet
   - iOS Safari/PWA: on bloque aussi le scroll via overflow:hidden (et JS touche)
*/
html, body{
  overscroll-behavior: none;
  overscroll-behavior-y: none;
  overflow: hidden;
  width: 100%;
  overflow-x: hidden;
}

/* ===== Polices embarquées ===== */
@font-face{
  font-family: "InterRegular";
  src: url("fonts/Inter-Regular.woff2") format("woff2");
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}
@font-face{
  font-family: "InterSemiBold";
  src: url("fonts/Inter-SemiBold.woff2") format("woff2");
  font-weight: 600;
  font-style: normal;
  font-display: swap;
}
@font-face{
  font-family: "InterItalic";
  src: url("fonts/Inter-Italic.woff2") format("woff2");
  font-weight: 400;
  font-style: italic;
  font-display: swap;
}
@font-face{
  font-family: "InterBold";
  src: url("fonts/Inter-Bold.woff2") format("woff2");
  font-weight: 700;
  font-style: normal;
  font-display: swap;
}
@font-face{
  font-family: "InterExtraBold";
  src: url("fonts/Inter-ExtraBold.woff2") format("woff2");
  font-weight: 800;
  font-style: normal;
  font-display: swap;
}
@font-face{
  font-family: "BravuraText";
  src: url("fonts/BravuraText.woff2") format("woff2"),
       url("fonts/BravuraText.woff") format("woff"),
       url("fonts/BravuraText.otf") format("opentype");
  font-weight: 400;
  font-style: normal;
  font-display: block;
}
@font-face{
  font-family: "STIXTwoTextItalic";
  src: url("fonts/STIXTwoText-Italic.ttf") format("truetype");
  font-weight: 400;
  font-style: italic;
  font-display: swap;
}

html, body { height: 100%; margin: 0; }

:root{
  /* Taille du cercle QUESTION (SVG ring) */
  --question-circle-size: calc(min(78vmin, 640px) * 1.2);
  --q-circle-size: var(--question-circle-size);
  --q-circle-stroke: 6px;
  /* Marge intérieure visuelle (le JS gère la taille du texte ; ici on évite juste que ça touche le trait) */
  --q-circle-safe: 20px;

  /* Taille du cercle ACCUEIL (image) */
  --home-circle-size: min(78vmin, 640px);
}

body{
  background:#000;
  color:#fff;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  padding-left: env(safe-area-inset-left);
  padding-right: env(safe-area-inset-right);
  box-sizing: border-box;
}

/* ===== Écran centré ===== */
.screen{
  height: 100vh;
  height: 100svh;
  height: 100dvh;
  min-height: 100vh;
  min-height: 100svh;
  min-height: 100dvh;

  display: grid;
  place-items: center;

  padding-top: env(safe-area-inset-top);
  padding-bottom: env(safe-area-inset-bottom);

  box-sizing: border-box;

  touch-action: manipulation;
  user-select: none;
  -webkit-user-select: none;
}

/* ===== Carte ===== */
.card{
  width: min(92vw, 980px);
  min-height: 70vh;
  display: grid;
  place-items: center;

  border-radius: 18px;
  padding: 12px 18px 36px;
  position: relative;

  /* Compensation iPhone (comme ton fichier) */
  margin-top: -10vh;

  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}

/* Fonds */
.card.home,
.card.question{
  background:#000;
  color:#fff;
}
.card.answer{
  background:#fff;
  color:#000;
}

/* ===== Zone cercle (sert de boîte de référence) ===== */
.circle{
  position: relative;
  display: grid;
  place-items: center;
  border-radius: 50%;
}

/* Accueil : vrai cercle avec image */
.card.home .circle{
  width: var(--home-circle-size);
  height: var(--home-circle-size);
  border: 6px solid #fff;
  overflow: hidden;
}
.card.home .home-image{
  display:block;
  width: 62%;
  height: 62%;
  object-fit: contain;
}
.card.home #content{ display:none; }

/* Question / Réponse : on utilise la même boîte carrée que le cercle question (pour aligner clip et ring) */
.card.question .circle,
.card.answer .circle{
  width: var(--q-circle-size);
  height: var(--q-circle-size);
  border: none;
  overflow: visible;
  border-radius: 0; /* la boîte est carrée; le cercle est dessiné par le SVG */
}

/* Cache l'image hors accueil */
.card.question .home-image,
.card.answer  .home-image{
  display:none;
}

/* ===== Contenu ===== */
#content, .content{
  text-align:center;
}

/* IMPORTANT:
   En mode QUESTION, #content devient *exactement* la même boîte que le cercle (var(--q-circle-size)),
   centrée au même endroit que le SVG ring. Ainsi, clip-path et ring sont parfaitement alignés.
*/
.card.question #content{
  position: absolute;
  left: 50%;
  top: 50%;
  width: var(--q-circle-size);
  height: var(--q-circle-size);
  transform: translate(-50%, -50%);

  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;

  margin: 0;
  max-width: none; /* CRITIQUE: sinon boîte différente du cercle */
  z-index: 1;

  /* Masque circulaire intérieur sûr */
  clip-path: circle(calc((var(--q-circle-size) / 2) - var(--q-circle-stroke) - var(--q-circle-safe)) at 50% 50%);

  will-change: transform;
}

/* En mode RÉPONSE, pas de clip (le texte n'est pas masqué) */
.card.answer #content{
  position: static;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;

  width: 100%;
  max-width: 92vw;
  margin: 0 auto;
}

/* ===== Typo ===== */
.q-line1, .a-line1{
  font-size: clamp(42px, 7vw, 110px);
  line-height: 1.05;
  white-space: nowrap;
  text-wrap: nowrap;

  /* shrink-wrap pour mesures fiables */
  display: inline-flex;
  justify-content: center;
  align-items: baseline;
  gap: 0;
  max-width: 100%;
}

.q-line2, .a-line2{
  display:block;
  font-size: clamp(40px, 6vw, 80px);
  line-height: 1.1;
  opacity: 0.9;
  font-family: "InterRegular", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  font-weight: 400;
}

/* Ligne 2 question jamais en gras */
.q-line2{ font-weight: 400; }

/* a2 un peu moins visible (comme ton fichier) */
.a-line2{ opacity: 0.8; }

/* Gras mots */
.qb{
  font-family: "InterExtraBold", "InterRegular", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  font-weight: 400; /* le poids visuel vient du fichier ExtraBold */
}

/* Conteneurs ne rajoutent pas de gras */
.q-line1, .a-line1{ font-weight: 400; }

/* Opérateurs non gras */
.op, .mult, .hyph{
  font-weight: 400 !important;
  font-family: "InterRegular", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif !important;
  font-synthesis: none;
}

/* Slash non gras */
.op.slash{ font-weight: 400 !important; }

/* Italique mathématique (STIX si dispo) */
.italic{
  font-family: "STIXTwoTextItalic", "InterItalic", serif !important;
  font-style: italic;
  font-weight: 400 !important;
}

/* Fraction empilée */
.frac{
  display: inline-grid;
  grid-template-rows: auto 0.05em auto;
  align-items: center;
  justify-items: center;
  line-height: 1.05;
}
.frac .bar{
  width: 100%;
  height: 0.06em;
  background: currentColor;
}
.frac .num, .frac .den{
  white-space: nowrap;
}

/* Exposants */
.content sup,
.a-line sup{
  font-size: 0.6em;
  vertical-align: baseline;
  position: relative;
  top: -0.75em;
}

/* a1_html: agrandit uniquement les réponses HTML */
.a1html{ font-size: 1.25em; }

/* ===== DIM GLOBAL (QUESTION → RÉPONSE seulement) ===== */
body::before{
  content:"";
  position: fixed;
  inset: 0;
  background: #000;
  opacity: 0;
  pointer-events: none;
  z-index: 5;
}
.flash-answer::before{
  animation: dimGlobal 140ms ease-out;
}
@keyframes dimGlobal{
  0%{opacity:0;}
  40%{opacity:0.12;}
  100%{opacity:0;}
}
@media (prefers-reduced-motion: reduce){
  .flash-answer::before{ animation:none; }
}

/* ===== SVG QUESTION RING =====
   (injecté par app.js : svg#qring-svg.qring)
*/
.qring{
  position:absolute;
  left:50%;
  top:50%;
  width: var(--q-circle-size);
  height: var(--q-circle-size);
  transform: translate(-50%, -50%);
  pointer-events:none;
  z-index:0;
}
.qring circle{
  fill: none;
  stroke: #fff;
  stroke-width: var(--q-circle-stroke);
  vector-effect: non-scaling-stroke;
}

/* + d’air entre la ligne 1 et la ligne 2 (question & réponse) */
.q-line1,
.a-line1{
  margin-bottom: 0.5em;  /* ajuste: 0.4em → 0.6em selon ton goût */
}

.q-line2,
.a-line2{
  margin-top: 0;        /* on évite de doubler les marges */
}

